<mat-tab-group *ngIf="data && myPropertiesBookings">
  <mat-tab label="Bookings of my properties">
    <ng-template matTabContent>
      <table
        *ngIf="myPropertiesBookings"
        mat-table
        [dataSource]="myPropertiesBookings"
        class="mat-elevation-z8"
      >
        <ng-container matColumnDef="propertyName">
          <th mat-header-cell *matHeaderCellDef>Property Name</th>
          <td mat-cell *matCellDef="let bookingOfMyProperty">
            {{ bookingOfMyProperty.propertyName }}
          </td>
        </ng-container>

        <ng-container matColumnDef="city">
          <th mat-header-cell *matHeaderCellDef>Name</th>
          <td mat-cell *matCellDef="let bookingOfMyProperty">
            {{ bookingOfMyProperty.city }}
          </td>
        </ng-container>

        <ng-container matColumnDef="checkInDate">
          <th mat-header-cell *matHeaderCellDef>Date</th>
          <td mat-cell *matCellDef="let bookingOfMyProperty">
            {{ bookingOfMyProperty.checkInDate }}
          </td>
        </ng-container>

        <ng-container matColumnDef="checkOutDate">
          <th mat-header-cell *matHeaderCellDef>Date</th>
          <td mat-cell *matCellDef="let bookingOfMyProperty">
            {{ bookingOfMyProperty.checkOutDate }}
          </td>
        </ng-container>

        <ng-container matColumnDef="totalPrice">
          <th mat-header-cell *matHeaderCellDef>Price</th>
          <td mat-cell *matCellDef="let bookingOfMyProperty">
            {{ bookingOfMyProperty.totalPrice }}
          </td>
        </ng-container>

        <ng-container matColumnDef="details">
          <th mat-header-cell *matHeaderCellDef>Property Details</th>
          <td mat-cell *matCellDef="let bookingOfMyProperty">
            <button
              mat-raised-button
              color="secondary"
              [routerLink]="[
                '/properties/details',
                bookingOfMyProperty.propertyId
              ]"
            >
              Property details
            </button>
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let bookingOfMyProperty">
            <button
              *ngIf="bookingOfMyProperty.bookingState == 'Pending'"
              mat-raised-button
              color="primary"
              (click)="acceptBooking(bookingOfMyProperty.id)"
            >
              Accept
            </button>
            <button
              *ngIf="bookingOfMyProperty.bookingState == 'Accepted'"
              mat-raised-button
              color="primary"
              disabled
            >
              Accepted
            </button>
            <button
              *ngIf="!bookingOfMyProperty.cancellationDate"
              mat-raised-button
              color="warn"
              (click)="cancelBookingAsHost(bookingOfMyProperty.id)"
            >
              Cancel
            </button>
          </td>
        </ng-container>

        <tr
          mat-header-row
          *matHeaderRowDef="myPropertiesBookingsDisplayedColumns"
        ></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: myPropertiesBookingsDisplayedColumns"
        ></tr>
      </table>
    </ng-template>
  </mat-tab>
  <mat-tab label="My bookings">
    <ng-template matTabContent>
      <table
        *ngIf="data"
        mat-table
        [dataSource]="data"
        multiTemplateDataRows
        class="mat-elevation-z8"
      >
        <ng-container
          matColumnDef="{{ column }}"
          *ngFor="let column of columnsToDisplay"
        >
          <th mat-header-cell *matHeaderCellDef>{{ column }}</th>
          <td mat-cell *matCellDef="let element">{{ element[column] }}</td>
        </ng-container>

        <ng-container matColumnDef="expandedDetail">
          <td
            mat-cell
            *matCellDef="let element"
            [attr.colspan]="columnsToDisplay.length"
          >
            <div
              class="example-element-detail"
              [@detailExpand]="
                element == expandedElement ? 'expanded' : 'collapsed'
              "
            >
              <div class="example-element-diagram">
                <div *ngIf="element.imageUrl" class="example-element-image">
                  <img [src]="element.imageUrl" />
                </div>
              </div>
              <div class="example-element-content">
                <div class="example-element-description">
                  {{ element.propertyName }}
                </div>
                <div class="example-element-description">
                  <span class="example-element-description-attribution"
                    >{{ element.address }}, {{ element.city }}</span
                  >
                </div>
                <div class="example-element-description">
                  {{ element.description }}
                </div>
                <div class="example-element-description">
                  Accommodates number:
                  {{ element.accommodatesNumber }}
                </div>
                <div class="example-element-description">
                  Bathroom number:
                  {{ element.bathroomNumber }}
                </div>
                <div class="example-element-description">
                  Bedroom number:
                  {{ element.bedroomNumber }}
                </div>
              </div>
              <div class="example-element-diagram">
                <button
                  mat-raised-button
                  color="primary"
                  [routerLink]="['/properties/details', element.propertyId]"
                >
                  Property details
                </button>
                <br />
                <button
                  *ngIf="!element.cancellationDate"
                  mat-raised-button
                  color="warn"
                  (click)="cancelBooking(element.id)"
                >
                  Cancel booking
                </button>
                <br />
                <button
                  *ngIf="element.cancellationDate"
                  mat-raised-button
                  color="warn"
                  disabled
                >
                  Booking cancelled {{ element.cancellationDate | date }}
                </button>
              </div>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
        <tr
          mat-row
          *matRowDef="let element; columns: columnsToDisplay"
          class="example-element-row"
          [class.example-expanded-row]="expandedElement === element"
          (click)="
            expandedElement = expandedElement === element ? null : element
          "
        ></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: ['expandedDetail']"
          class="example-detail-row"
        ></tr>
      </table>
    </ng-template>
  </mat-tab>
</mat-tab-group>
